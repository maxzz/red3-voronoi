var e=Object.defineProperty,t=Object.defineProperties,r=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,c=(t,r,n)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[r]=n,s=(e,t)=>{for(var r in t||(t={}))a.call(t,r)&&c(e,r,t[r]);if(n)for(var r of n(t))l.call(t,r)&&c(e,r,t[r]);return e},o=(e,t)=>{var r={};for(var c in e)a.call(e,c)&&t.indexOf(c)<0&&(r[c]=e[c]);if(null!=e&&n)for(var c of n(e))t.indexOf(c)<0&&l.call(e,c)&&(r[c]=e[c]);return r};import{r as i,p,R as m,u,s as h,L as d,a as f,b as y}from"./vendor.db3acc58.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const r of e)if("childList"===r.type)for(const e of r.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const x=()=>{const e=i.exports.useRef(null);return i.exports.useEffect((()=>{e.current&&(p.setup(e.current),(()=>{let e=new p.Path;p.view.onMouseDown=t=>{e.strokeColor=new p.Color("white"),e.strokeWidth=3},p.view.onMouseUp=t=>{e.simplify(10),e.selected=!0},p.view.onMouseDrag=t=>{e.add(t.point)}})())}),[]),m.createElement("div",null,m.createElement("canvas",{width:300,height:300,ref:e,className:"bg-pink-300"},"B"))};const g=i.exports.createContext({points:[],setPoints:()=>{},tolerance:0,setTolerance:()=>{},showRaw:!0,setShowRaw:()=>{},showPts:!0,setShowPts:()=>{},showCtr:!0,setShowCtr:()=>{}}),E=({children:e})=>{const[t,r]=m.useState([]),[n,a]=m.useState(12),[l,c]=m.useState(!0),[s,o]=m.useState(!0),[i,p]=m.useState(!0);return m.createElement(g.Provider,{value:{points:t,setPoints:r,tolerance:n,setTolerance:a,showRaw:l,setShowRaw:c,showPts:s,setShowPts:o,showCtr:i,setShowCtr:p}},e)};var w,v;(v=w||(w={}))[v.defined=1]="defined",v[v.computed=2]="computed";const b="\t\n\v\f\r   ᠎             　\u2028\u2029",k=new RegExp(`([a-z])[${b},]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?[${b}]*,?[${b}]*)+)`,"ig"),C=new RegExp(`(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)[${b}]*,?[${b}]*`,"ig");function S(e){let t=[],r={x:0,y:0};return e.forEach((e=>{let n=e[0],a=r;switch(n){case"M":case"L":case"T":a={x:e[1],y:e[2]};break;case"H":a={x:e[1],y:r.y};break;case"V":a={x:r.x,y:e[1]};break;case"C":a={x:e[5],y:e[6]};break;case"S":case"Q":a={x:e[3],y:e[4]};break;case"A":a={x:e[6],y:e[7]}}t.push(a),r=a})),t}function M(e){let t=[],r={x:0,y:0},n=[];return e.forEach(((e,a,l)=>{let c=e[0],s={x:0,y:0};switch(c){case"M":case"L":s={x:e[1],y:e[2]};break;case"H":s={x:e[1],y:r.y};break;case"V":s={x:r.x,y:e[1]};break;case"C":s={x:e[5],y:e[6]},t.push({i:a,n:c,pt:r,cp:{x:e[1],y:e[2]},t:1}),t.push({i:a,n:c,pt:s,cp:{x:e[3],y:e[4]},t:1});break;case"S":{s={x:e[3],y:e[4]};let n=l[a-1];switch(n[0]){case"C":case"S":let e="C"===n[0]?3:1,l={x:2*r.x-n[e],y:2*r.y-n[e+1]};t.push({i:a,n:c,pt:r,cp:l,t:2})}t.push({i:a,n:c,pt:s,cp:{x:e[1],y:e[2]},t:1});break}case"Q":s={x:e[3],y:e[4]};let o={x:e[1],y:e[2]};t.push({i:a,n:c,pt:r,cp:o,t:1}),t.push({i:a,n:c,pt:s,cp:o,t:1});break;case"T":{let o=function(e,t){let r=l[e-1];if(r){if("Q"===r[0])return{x:2*t.x-r[1],y:2*t.y-r[2]};if("T"===r[0]){let r=o(e-1,n[e-2]||t);return{x:2*t.x-r.x,y:2*t.y-r.y}}}return t},i=o(a,r);s={x:e[1],y:e[2]},t.push({i:a,n:c,pt:r,cp:i,t:2}),t.push({i:a,n:c,pt:s,cp:i,t:2});break}case"A":s={x:e[6],y:e[7]}}n.push(r=s)})),t}function N(e,t=2){return e.toFixed(Math.max(Math.min(t,20),0))}function P(e){const t=function(e){if(!e||!e.length)return[["M",0,0]];let t,r=[],n=0,a=0,l=0,c=0,s=0;"M"==e[0][0]&&(n=+e[0][1],a=+e[0][2],l=n,c=a,s++,r[0]=["M",n,a]);for(let o,i,p=s,m=e.length;p<m;p++){if(r.push(o=[]),i=e[p],t=i[0],t!=t.toUpperCase())switch(o[0]=t.toUpperCase(),o[0]){case"A":o[1]=i[1],o[2]=i[2],o[3]=i[3],o[4]=i[4],o[5]=i[5],o[6]=+i[6]+n,o[7]=+i[7]+a;break;case"V":o[1]=+i[1]+a;break;case"H":o[1]=+i[1]+n;break;case"M":l=+i[1]+n,c=+i[2]+a;default:for(let e=1,t=i.length;e<t;e++)o[e]=+i[e]+(e%2?n:a)}else for(let e=0,t=i.length;e<t;e++)o[e]=i[e];switch(o[0]){case"Z":n=+l,a=+c;break;case"H":n=o[1];break;case"V":a=o[1];break;case"M":l=o[o.length-2],c=o[o.length-1];default:n=o[o.length-2],a=o[o.length-1]}}return r}(function(e){if(!e)return[];let t={a:7,c:6,o:2,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,u:3,z:0},r=[];return e.replace(k,(function(e,n,a,l,c,...s){let o=[],i=n.toLowerCase();if(a.replace(C,(function(e,t,r,...n){t&&o.push(+t)})),"m"==i&&o.length>2&&(r.push([n].concat(o.splice(0,2))),i="l",n="m"==n?"l":"L"),"o"==i&&1==o.length&&r.push([n,o[0]]),"r"==i)r.push([n].concat(o));else for(;o.length>=t[i]&&(r.push([n].concat(o.splice(0,t[i]))),t[i]););})),r}(e));return{points:t.length>1?S(t):[],controls:t.length>1?M(t):[]}}function R(e){var t=e,{pts:r}=t,n=o(t,["pts"]);return n=s({stroke:"blue",fill:"purple"},n),m.createElement("g",s({},n),r.map(((e,t)=>m.createElement("circle",{cx:e[0],cy:e[1],r:3,key:t},m.createElement("title",null,t,": x:",e[0]," y: ",e[1])))))}function O(e){var t=e,{pts:r}=t,n=o(t,["pts"]);return n=s({r:"7",stroke:"red",fill:"orange"},n),m.createElement("g",null,r.map(((e,t)=>m.createElement(m.Fragment,{key:t},m.createElement("circle",s({cx:e.x,cy:e.y},n),m.createElement("title",null,t,": x:",e.x," y: ",e.y)),m.createElement("text",{x:e.x+7,y:e.y,fontSize:"7",stroke:"none"},t)))))}function T(e){var t,r,n=e,{cpts:a}=n,l=o(n,["cpts"]);return l=s({stroke:"maroon",strokeWidth:"1",fill:"tomato"},l),(r=t||(t={}))[r.width=8]="width",m.createElement("g",s({},l),a.map(((e,t)=>m.createElement(m.Fragment,{key:t},m.createElement("rect",{x:e.cp.x-4,y:e.cp.y-4,width:8,height:8,fill:e.t===w.computed?"none":l.fill},m.createElement("title",null,"Command ",e.n,": ",e.i,": Location: ",N(e.cp.x,0)," x ",N(e.cp.y,0))),m.createElement("line",{x1:e.pt.x,y1:e.pt.y,x2:e.cp.x,y2:e.cp.y,strokeDasharray:"2 2"})))))}function z({children:e,pressed:t,onClick:r,title:n}){return m.createElement("div",{className:"w-8 h-8 border rounded "+(t?"bg-red-200":"shadow"),onClick:r,title:n},e)}const L=()=>{const e=m.useRef(null),{points:n,setPoints:a,tolerance:l,setTolerance:c,showRaw:o,setShowRaw:p,showPts:d,setShowPts:f,showCtr:y,setShowCtr:x}=i.exports.useContext(g),E=i.exports.useCallback(function(e,t=100){let r,n,a;return function(...l){a=this,n=l,r||(r=setTimeout((()=>{r=null,e.apply(a,n)}),t))}}((e=>a((t=>[...t,e]))),50),[]),w=u((t=>{t.dragging&&1===t.buttons&&E(function(e,t){var r;if(void 0===t&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var a=n.createSVGPoint();return a.x=e.clientX,a.y=e.clientY,[(a=a.matrixTransform(null==(r=t.getScreenCTM())?void 0:r.inverse())).x,a.y]}if(t.getBoundingClientRect){var l=t.getBoundingClientRect();return[e.clientX-l.left-t.clientLeft,e.clientY-l.top-t.clientTop]}}return[e.pageX,e.pageY]}(t.event,e.current))})),v=m.useMemo((()=>n.length>1?h(n,{tolerance:l}):""),[n,l]),b=m.useMemo((()=>P(v)),[v]);return m.createElement("div",{className:"relative text-gray-700 select-none"},m.createElement("svg",(k=s({ref:e},w()),t(k,r({width:500,height:500,className:"bg-purple-300"}))),m.createElement("path",{fill:"none",stroke:"orange",strokeWidth:3,d:v}),o&&m.createElement(R,{pts:n}),d&&m.createElement(O,{pts:b.points}),y&&m.createElement(T,{cpts:b.controls})),m.createElement("div",{className:"ml-2 mb-2 absolute bottom-0 flex items-center space-x-4"},m.createElement("button",{className:"p-2 border border=gray-400 rounded shadow",onClick:()=>a([])},"Clear"),m.createElement("div",{className:"pb-1 flex flex-col text-sm"},m.createElement("div",{className:"flex items-center space-x-2"},m.createElement("div",{className:""},"Tolerance:"),m.createElement("input",{className:"w-32",type:"range",value:l,onChange:e=>c(+e.target.value),min:0,max:100,step:.01}),m.createElement("div",{className:"w-12"},l)),m.createElement("div",{className:""},"Points: ",n.length," -> ",b.points.length)),m.createElement("div",{className:"flex space-x-1"},m.createElement(z,{pressed:o,onClick:()=>p((e=>!e)),title:"show raw points"},m.createElement("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},m.createElement("path",{d:"M14 7.1a8.3 8.3 0 016.3 7.8m-16.7-.1A8.3 8.3 0 0110 7.1"}),m.createElement("path",{d:"M14 6.9a1 1 0 010 .2 2 2 0 01-4 0 2 2 0 010-.2 2 2 0 014 0z"}),m.createElement("circle",{cx:"3.6",cy:"16.9",r:"2"}),m.createElement("circle",{cx:"20.4",cy:"16.9",r:"2"}))),m.createElement(z,{pressed:d,onClick:()=>f((e=>!e)),title:"show smooth points"},m.createElement("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},m.createElement("path",{d:"M13.9 7.1a8.3 8.3 0 016.4 7.8m-16.6-.1a8.3 8.3 0 016.2-7.7"}),m.createElement("path",{d:"M1.6 15.1h4v4h-4zm16.8 0h4v4h-4zM9.9 4.9h4v4h-4z"}))),m.createElement(z,{pressed:y,onClick:()=>x((e=>!e)),title:"show point handles"},m.createElement("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},m.createElement("path",{d:"M14 7.1a8.3 8.3 0 016.4 7.8m-16.7-.1A8.4 8.4 0 0110 7.1"}),m.createElement("path",{d:"M1.6 15.1h4v4h-4zm16.8 0h4v4h-4z"}),m.createElement("path",{d:"M118.6 93.4v4h-4v-4zm-3.9 2.2h-.1z",transform:"translate(-104.6 -88.5)"}),m.createElement("path",{className:"cls-3",d:"M20.4 7.2h-6.5m-4 0H3.6"}))))));var k};function j(){return m.createElement("div",{className:"h-screen flex flex-col bg-purple-200"},m.createElement("header",{className:"flex-none bg-gray-200 p-2"},m.createElement("div",{className:""},m.createElement("ul",{className:"space-x-2 flex items-center"},m.createElement("li",{className:""},m.createElement(d,{className:"block p-2 rounded bg-gray-50 border border-gray-400 shadow",to:"simplify-react"},"Simplify: React")),m.createElement("li",{className:""},m.createElement(d,{className:"block p-2 rounded bg-gray-50 border border-gray-400 shadow",to:"simplify-paper"},"Simplify: Parer"))))),m.createElement(E,null,m.createElement(f,{className:"flex-1 bg-green-400"},m.createElement(L,{path:"simplify-react"}),m.createElement(x,{path:"simplify-paper"}))))}y.render(m.createElement(m.StrictMode,null,m.createElement(j,null)),document.getElementById("root"));
